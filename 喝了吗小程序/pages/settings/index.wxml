<!-- pages/settings/index.wxml -->
<view class="container">
  <!-- 标题栏 -->
  <view class="header">
    <navigator class="back-btn" url="{{firstLogin ? '/pages/home/index' : '/pages/home/index'}}">
      <image src="/images/back-icon.png" mode="aspectFit"></image>
      <text>返回</text>
    </navigator>
    <button class="save-btn" bindtap="saveSettings">保存</button>
  </view>

  <!-- 用户信息 -->
  <view class="user-section">
    <view class="user-avatar">
      <image src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
    </view>
    <view class="user-details">
      <text class="user-name">{{userInfo.nickName || '用户'}}</text>
      <text class="user-desc">坚持喝水，健康生活</text>
    </view>
  </view>

  <!-- 设置项 -->
  <view class="settings-section">
    <!-- 每日目标 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>每日目标</text>
        <text class="setting-value">{{dailyGoal}} 杯</text>
      </view>
      <slider 
        class="setting-slider" 
        min="6" 
        max="12" 
        value="{{dailyGoal}}" 
        bindchanging="onDailyGoalChange"
        activeColor="#2b8cee"
        background="#e5e7eb"
      />
      <view class="slider-indicators">
        <text>6杯</text>
        <text>12杯</text>
      </view>
    </view>

    <!-- 提醒间隔 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>提醒间隔</text>
        <text class="setting-value">{{reminderInterval}}分钟</text>
      </view>
      <picker class="setting-picker" range="{{intervalOptions}}" bindchange="onIntervalChange" value="{{selectedIntervalIndex}}">
        <view class="picker-display">{{intervalOptions[selectedIntervalIndex]}}</view>
      </picker>
    </view>

    <!-- 免打扰模式 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>免打扰模式</text>
        <switch class="setting-switch" checked="{{quietModeEnabled}}" bindchange="onQuietModeChange" />
      </view>
      <view class="quiet-hours" wx:if="{{quietModeEnabled}}">
        <view class="quiet-time">
          <text>开始时间</text>
          <picker class="time-picker" mode="time" value="{{quietStartTime}}" bindchange="onStartTimeChange">
            <view class="time-display">{{quietStartTime}}</view>
          </picker>
        </view>
        <view class="quiet-time">
          <text>结束时间</text>
          <picker class="time-picker" mode="time" value="{{quietEndTime}}" bindchange="onEndTimeChange">
            <view class="time-display">{{quietEndTime}}</view>
          </picker>
        </view>
      </view>
    </view>

    <!-- 通知音效 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>通知音效</text>
        <text class="setting-value">{{soundName}}</text>
      </view>
      <picker class="setting-picker" range="{{soundOptions}}" bindchange="onSoundChange" value="{{selectedSoundIndex}}">
        <view class="picker-display">{{soundOptions[selectedSoundIndex]}}</view>
      </picker>
    </view>

    <!-- 触觉反馈 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>触觉反馈</text>
        <switch class="setting-switch" checked="{{hapticEnabled}}" bindchange="onHapticChange" />
      </view>
    </view>

    <!-- 通知开关 -->
    <view class="setting-item">
      <view class="setting-label">
        <text>智能提醒</text>
        <switch class="setting-switch" checked="{{notificationsEnabled}}" bindchange="onNotificationsChange" />
      </view>
    </view>
  </view>

  <!-- 帮助与反馈 -->
  <view class="footer-section">
    <navigator class="footer-link" url="/pages/feedback/index">意见反馈</navigator>
    <navigator class="footer-link" url="/pages/about/index">关于我们</navigator>
    <button class="footer-btn" bindtap="resetData">重置数据</button>
  </view>
</view>